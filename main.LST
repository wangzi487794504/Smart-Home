C51 COMPILER V9.01   MAIN                                                                  05/21/2020 18:25:15 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          # include <reg51.h>
   2          # include <intrins.h>
   3          # include "shou.h"
   4          # include "delay.h"
   5          # include "1602.h"
   6          # include "dht11.h"
   7          # include "wifi.h"
   8          # include"yidi.h"
   9          typedef unsigned char BYTE;
  10          typedef unsigned int WORD;
  11          #define uint unsigned int 
  12          #define uchar unsigned char 
  13          #define RELOAD_COUNT 0xFA //宏定义波特率发生器的载入值 9600
  14          sbit moto=P1^3;
  15          sbit weishengjian= P2^0;        //卫生间灯
  16          sbit keting= P2^1;
  17          sbit wodshi=P2^2;
  18          sbit chufang=P2^3;
  19          uchar Time;
  20          char biaozhi;
  21          
  22          //***************************************************************  
  23          /*
  24          *@author 王子杰
  25          *@version 1.1
  26          *@group 蚌埠医学院
  27          */
  28          void UART_Init()
  29          {
  30   1              SCON=0X50;                      //设置为工作方式1
  31   1              TMOD=0X20;                      //设置计数器工作方式2
  32   1              PCON=0X80;                      //波特率加倍
  33   1              TH1=0XF3;       //计数器初始值设置
  34   1              TL1=0XF3;
  35   1              ES=0;                           //关闭接收中断
  36   1              EA=1;                           //打开总中断
  37   1              TR1=1;                          //打开计数器
  38   1      }
  39          void denginit()//灯的初始化
  40          {
  41   1               weishengjian=1;
  42   1               keting=1;
  43   1               wodshi=1;
  44   1               chufang=1;
  45   1      }
  46          
  47          void jieshou(uchar value)//处理wifi模块接受的数据 ,按照java知识，应该降低耦合,但它类似于主线程，写其他地方
             -会失效。
  48          {
  49   1              if(value=='0')
  50   1              {
  51   2                 moto=1;//低电平亮
  52   2              }
  53   1              if(value=='1')
  54   1              {
C51 COMPILER V9.01   MAIN                                                                  05/21/2020 18:25:15 PAGE 2   

  55   2                 weishengjian=0;//低电平亮
  56   2              }
  57   1              if(value=='2')
  58   1              {
  59   2                 keting=0;
  60   2              }
  61   1              if(value=='3')
  62   1              {
  63   2                 wodshi=0;
  64   2              }
  65   1              if(value=='4')
  66   1              {
  67   2                 chufang=0;
  68   2              }
  69   1              if(value=='5')
  70   1              {
  71   2                 moto=0;
  72   2              }
  73   1              if(value=='6')
  74   1              {
  75   2                 weishengjian=1;
  76   2              }
  77   1              if(value=='7')
  78   1              {
  79   2                keting=1;
  80   2              }
  81   1              if(value=='8')
  82   1              {
  83   2                wodshi=1;
  84   2              }
  85   1              if(value=='9')
  86   1              {
  87   2                chufang=1;
  88   2              } 
  89   1      }
  90          void main()
  91          {
  92   1               ESP8266_ModeInit();
  93   1           UART_Init();
  94   1               denginit();
  95   1               moto=0;
  96   1               while(1)
  97   1               {
  98   2                   datashow();
  99   2                       delay_h(3000);
 100   2      
 101   2               }
 102   1      }
 103          void Uart() interrupt 4            //利用串口中断接收wifi数据
 104          {
 105   1         
 106   1         if(RI==1)
 107   1         {
 108   2              uchar receiveData;
 109   2                 receiveData=SBUF;//出去接收到的数据
 110   2              RI = 0;//清除接收中断标志位
 111   2                  jieshou(receiveData);
 112   2       }
 113   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.01   MAIN                                                                  05/21/2020 18:25:15 PAGE 3   

   CODE SIZE        =    128    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
